# ~/.pk_aliases - PiKaraoke user commands (installer-focused)

export PK_HOME="$HOME/deskpi-karaoke"   # your installer repo
export PK_VENV="$HOME/.venv"
export PK_LOG="$HOME/pikaraoke_output.log"

pk() {
  case "$1" in
    update)
        echo "ğŸ“¥ Updating PiKaraoke *installer*..."
        cd "$PK_HOME" || { echo "âŒ Installer repo not found at $PK_HOME"; return 1; }
        git pull --ff-only || { echo "âŒ Git update failed"; return 1; }
        echo "â–¶ï¸ Applying installer updates..."
        python3 install.py || { echo "âŒ Installer update failed"; return 1; }
        echo "â™»ï¸ Rebooting to let PiKaraoke self-check run on boot..."
        sudo reboot
        ;;
    start)
        echo "ğŸ¤ Starting PiKaraoke..."
        # If your app requires the venv to run, keep this; otherwise itâ€™s harmless.
        source "$PK_VENV/bin/activate" 2>/dev/null || true
        nohup pikaraoke > "$PK_LOG" 2>&1 &
        echo "â„¹ï¸ Running in background (log: $PK_LOG)"
        ;;
    help|*|"")
        echo ""
        echo "ğŸ“Œ PiKaraoke Commands:"
        echo "   pk update  â†’ Update the *installer* and reboot (PiKaraoke itself updates on next boot)"
        echo "   pk start   â†’ Start PiKaraoke manually (if you exited the app)"
        echo "   pk help    â†’ Show this help message"
        echo ""
        ;;
  esac
}
